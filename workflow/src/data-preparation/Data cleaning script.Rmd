---
title: "Cleaning salary data"
author: "ollon"
date: "3/14/2021"
output: html_document
---
## Cleaning steps
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
This script contains the necessary steps to prepare our raw data for the final analysis. In our dataset, especially the salary data is very messy.  The salary column contains multiple missing values and multiple formats for salary, ranging from hourly wages to yearly income. 

First we load the required packages to perform the cleaning process into our worklow, also we read in the data in this step. 
```{r}
getwd()
library(dplyr)
library(stringr)
library(tidyr)

df1 <- read.csv("./data-analist.csv")
```

In the next step we will clean the salary column of our dataset. In order to be able to carry out analysis on differences in salaries for different skills we will have to format the current data. Right now some of the salary values are given as hourly wages where others are monthly or yearly incomes. We will convert all of the salary into yearly incomes based on the number of working hours in a year for an average job. 
```{r}
df2 <- df1 %>% 
   mutate(salary1 = str_remove_all(Salary, '[^0-9-,â‚¬]+')) %>% 
   separate(salary1, into = c('salary1', 'salary2'), 
           convert = TRUE, extra = 'drop') %>%
   mutate(across(c(salary1, salary2),
    ~ case_when(str_detect(Salary, "per maand") ~ . * 12, 
               str_detect(Salary, 'per uur') ~ . * 40 * 4 * 12, 
               nchar(.) < 5 ~ as.numeric(str_pad(., pad = '0', 
                   side = 'right', width = 5)),
             TRUE ~ as.numeric(.)))) %>% 
    transmute(output = rowMeans(select(., salary1, salary2), na.rm = TRUE))



```


##

Now we join the two dataframes together again to have the right salary values for each job based on yearly salaries.Afterwards we remove missing values. 

```{r}
df <- cbind(df1, df2)
df <- df[!is.na(df$output),]
```


